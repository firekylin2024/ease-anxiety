<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心安处 - 焦虑缓解小站</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .page {
            min-height: 100vh;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }
        
        .page.active {
            display: flex;
        }
        
        /* 页面1：卡片选择 */
        .selection-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            line-height: 1.6;
        }
        
        .cards-container {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-color);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        
        .card-controllable { --accent-color: #4CAF50; }
        .card-semi-controllable { --accent-color: #FF9800; }
        .card-uncontrollable { --accent-color: #2196F3; }
        
        .character {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .card-subtitle {
            font-size: 0.95rem;
            color: #7f8c8d;
            margin-bottom: 20px;
        }
        
        .examples {
            text-align: left;
            color: #5a6c7d;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .examples ul {
            list-style: none;
            padding: 0;
        }
        
        .examples li {
            padding: 4px 0;
            position: relative;
            padding-left: 15px;
        }
        
        .examples li:before {
            content: '•';
            color: var(--accent-color);
            position: absolute;
            left: 0;
        }
        
        /* 页面2：心理暗示 */
        .affirmation-page {
            background: var(--page-bg);
            text-align: center;
        }
        
        .affirmation-content {
            max-width: 600px;
            color: white;
        }
        
        .affirmation-text {
            font-size: 1.8rem;
            line-height: 1.5;
            margin-bottom: 40px;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .breathing-guide {
            font-size: 1.1rem;
            opacity: 0.8;
            margin-bottom: 30px;
        }
        
        .breathing-circle {
            width: 100px;
            height: 100px;
            border: 3px solid rgba(255,255,255,0.5);
            border-radius: 50%;
            margin: 0 auto 40px;
            position: relative;
            animation: breathe 4s infinite;
        }
        
        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .progress-bar {
            width: 200px;
            height: 4px;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            margin: 0 auto;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: white;
            width: 0%;
            border-radius: 2px;
            animation: progress 15s linear;
        }
        
        @keyframes progress {
            to { width: 100%; }
        }
        
        /* 页面3：过渡询问 */
        .transition-page {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            text-align: center;
        }
        
        .transition-content {
            color: white;
            max-width: 400px;
        }
        
        .transition-question {
            font-size: 1.6rem;
            margin-bottom: 30px;
            font-weight: 300;
        }
        
        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .choice-btn {
            background: white;
            color: #2c3e50;
            border: none;
            padding: 18px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .choice-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        /* 页面4：故事阅读 */
        .story-page {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .story-content {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            max-width: 600px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin: 20px auto;
        }
        
        .story-title {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .story-text {
            font-size: 1rem;
            line-height: 1.7;
            color: #34495e;
            margin-bottom: 25px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .story-reflection {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            margin-bottom: 25px;
            font-size: 0.95rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        
        .story-actions {
            text-align: center;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .story-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .story-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        /* 返回按钮 */
        .back-btn {
            position: absolute;
            top: 30px;
            left: 30px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .affirmation-text { font-size: 1.5rem; }
            .transition-question { font-size: 1.4rem; }
            .story-content { padding: 30px 20px; margin: 20px; }
            .back-btn { top: 20px; left: 20px; }
        }
    </style>
</head>
<body>
    <!-- 页面1：选择焦虑类型 -->
    <div class="page selection-page active" id="selection">
        <div class="header">
            <h1>心安处</h1>
            <p>你的焦虑，属于哪一种？</p>
        </div>
        
        <div class="cards-container">
            <div class="card card-controllable" onclick="selectAnxietyType('controllable')">
                <div class="character">🌱</div>
                <h3 class="card-title">我可以改变它</h3>
                <p class="card-subtitle">像幼苗一样，用心浇灌成长</p>
                <div class="examples">
                    <ul>
                        <li>工作表现和学习成绩</li>
                        <li>人际沟通和社交技巧</li>
                        <li>生活习惯和时间管理</li>
                        <li>技能提升和能力培养</li>
                    </ul>
                </div>
            </div>
            
            <div class="card card-semi-controllable" onclick="selectAnxietyType('semi-controllable')">
                <div class="character">☯️</div>
                <h3 class="card-title">我能影响一部分</h3>
                <p class="card-subtitle">像太极师一样，顺势而为</p>
                <div class="examples">
                    <ul>
                        <li>健康状况和身体机能</li>
                        <li>工作机会和职业发展</li>
                        <li>亲密关系和家庭和谐</li>
                        <li>投资理财和经济状况</li>
                    </ul>
                </div>
            </div>
            
            <div class="card card-uncontrollable" onclick="selectAnxietyType('uncontrollable')">
                <div class="character">🌊</div>
                <h3 class="card-title">我无法控制它</h3>
                <p class="card-subtitle">像大海一样，包容接纳一切</p>
                <div class="examples">
                    <ul>
                        <li>他人的想法和行为</li>
                        <li>过去发生的事情</li>
                        <li>未来的不确定性</li>
                        <li>自然环境和社会变化</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 页面2：心理暗示 -->
    <div class="page affirmation-page" id="affirmation">
        <button class="back-btn" onclick="goBack()">← 返回</button>
        <div class="affirmation-content">
            <div class="affirmation-text" id="affirmationText">
                <!-- 暗示内容将由JS填入 -->
            </div>
            <div class="breathing-guide">深呼吸三次，让这句话慢慢沉入心里</div>
            <div class="breathing-circle"></div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>
    
    <!-- 页面3：过渡询问 -->
    <div class="page transition-page" id="transition">
        <div class="transition-content">
            <div class="transition-question">感觉好一些了吗？</div>
            <div class="choice-buttons">
                <button class="choice-btn" onclick="goToStory()">想听一个温暖的故事 ✨</button>
                <button class="choice-btn" onclick="endSession()">今天就到这里，谢谢 🙏</button>
            </div>
        </div>
    </div>
    
    <!-- 页面4：故事阅读 -->
    <div class="page story-page" id="story">
        <button class="back-btn" onclick="goBack()">← 返回</button>
        <div class="story-content">
            <h2 class="story-title" id="storyTitle"><!-- 故事标题 --></h2>
            <div class="story-text" id="storyText">
                <!-- 故事内容 -->
            </div>
            <div class="story-reflection" id="storyReflection">
                <!-- 启发思考 -->
            </div>
            <div class="story-actions">
                <button class="story-btn" onclick="anotherStory()">再听一个故事</button>
                <button class="story-btn" onclick="startOver()">重新开始</button>
            </div>
        </div>
    </div>
    
    <script>
        let currentAnxietyType = '';
        let currentPage = 'selection';
        let usedStories = {
            controllable: [],
            'semi-controllable': [],
            uncontrollable: []
        };
        let currentStoryIndex = -1;
        
        // 暗示语句库
        const affirmations = {
            controllable: [
                "我有能力通过努力改变现状",
                "每一个小步骤都在让我变得更好",
                "我可以学习，我可以成长，我可以改变",
                "困难是我成长路上的垫脚石"
            ],
            'semi-controllable': [
                "我会尽我所能，然后平静接受结果",
                "有些事我能影响，有些事我需要顺应",
                "我专注于自己能控制的部分",
                "在变化中寻找平衡，在努力中保持从容"
            ],
            uncontrollable: [
                "这种感受是正常的，我允许它存在",
                "有些事情超出我的控制，我选择放下",
                "像大海一样，我可以包容一切",
                "接纳当下的自己，就是最大的勇气"
            ]
        };
        
        // 故事库
        const stories = {
            controllable: [
                {
                    title: "徐霞客：用脚步丈量梦想",
                    text: `明朝有个人叫徐霞客，出生在一个普通的江南家庭。年轻时他就有个"疯狂"的想法：要走遍天下的名山大川，亲眼看看书里描述的奇景。\n\n家人朋友都觉得他不务正业，那个年代，读书人应该考科举当官才对。但徐霞客没有放弃，他开始每天阅读地理古籍，学习野外生存技能，还坚持体能训练。\n\n22岁开始，他真的出发了。没有现代的地图和工具，只凭着一双脚和一颗坚定的心。三十多年里，他走过了大半个中国，记录下详细的地理观察，最终写成了《徐霞客游记》。\n\n最神奇的是，他的很多发现比西方地理学家早了几百年。别人觉得不可能的事，他用一步一个脚印证明了可能。`,
                    reflection: "💭 徐霞客告诉我们：梦想再远大，都可以拆解成每一天的具体行动。你今天迈出的每一小步，都在向着目标靠近。改变，从现在开始。"
                },
                {
                    title: "曾国藩：笨鸟先飞的智慧",
                    text: `曾国藩并不是天才。考秀才考了七次才过，记忆力也不好，别人背书一遍就会，他要背十遍。\n\n但他有个习惯，每天晚上都要写日记反思自己：今天做了什么？哪里做得不好？明天怎么改进？他给这叫"日课"。\n\n别人笑他笨，他就说："天下古今之庸人，皆以一惰字致败；天下古今之才人，皆以一傲字致败。"他知道自己不够聪明，所以更加勤奋。\n\n就这样一天天积累，他从一个普通的湖南农家子弟，成长为晚清重臣，被称为"千古完人"。他证明了：天赋不够，可以用方法和坚持来弥补。`,
                    reflection: "💭 曾国藩教给我们：不怕起点低，就怕不坚持。每天进步一点点，时间会给你最好的回报。"
                },
                {
                    title: "海伦·凯勒：在黑暗中点亮光明",
                    text: `海伦·凯勒19个月大时因病失去了听力和视力，生活在无声无光的世界里。7岁前，她像个小野兽一样，发脾气、摔东西，无法与外界交流。\n\n直到安妮·沙利文老师来到她身边。老师在她手心里一遍遍地写字母，试图让她理解语言。起初海伦完全不懂，但老师没有放弃。\n\n转机出现在井边。老师让海伦摸着水流，然后在她手心写下"水"这个单词。突然间，海伦明白了！原来一切事物都有名字！\n\n从那天起，她如饥似渴地学习。最终不仅学会了读写，还掌握了多种语言，成为著名作家和社会活动家。她用自己的经历告诉世界：再大的障碍，都阻挡不了学习的决心。`,
                    reflection: "💭 海伦·凯勒提醒我们：困难从来不是借口，只要愿意学习和改变，就能创造奇迹。"
                },
                {
                    title: "褚时健：74岁的重新开始",
                    text: `褚时健曾经是中国"烟王"，把一个小烟厂做成亚洲第一。但75岁时，他却因为经济问题入狱。出狱时已经74岁，妻子重病，家庭破败。\n\n很多人以为他的人生就此结束了。但褚时健说："我不甘心，我要证明自己。"他选择了种橙子，在云南的山上重新开始。\n\n74岁的老人，每天6点起床，到果园里查看果树生长情况。别人种橙子靠经验，他靠科学，研究土壤、气候、技术。有人问他为什么这么拼，他说："我要让大家知道，褚时健还没有倒下。"\n\n10年后，"褚橙"成为全国知名品牌。84岁的褚时健再次证明：只要开始行动，什么时候都不算晚。`,
                    reflection: "💭 褚时健告诉我们：人生永远有重新开始的机会，关键是要有重新开始的勇气和行动力。"
                },
                {
                    title: "马云：从英语老师到商业传奇",
                    text: `1995年，31岁的马云还是杭州电子工业学院的英语老师，月薪90元。第一次接触互联网时，他试着搜索"beer"（啤酒），结果有德国啤酒、美国啤酒，就是没有中国啤酒。\n\n他意识到这是个机会，决定创业做网站。但他不懂技术，不懂管理，连电脑都不太会用。第一次融资被拒绝了20多次，投资人都觉得他在讲天方夜谭。\n\n但马云没有放弃。他说："今天很残酷，明天更残酷，后天很美好，但绝大部分人死在明天晚上。"他开始疯狂学习商业知识，研究互联网，一遍遍修改商业计划。\n\n阿里巴巴成立初期，18个人挤在湖畔花园的小房子里，每天工作16小时。马云用自己的坚持和学习能力，最终把阿里巴巴做成了全球最大的电商平台之一。`,
                    reflection: "💭 马云的经历说明：不懂没关系，可以学；起点低没关系，可以努力；被拒绝没关系，可以坚持。"
                }
            ],
            'semi-controllable': [
                {
                    title: "苏轼：在困境中寻找诗意",
                    text: `苏轼的一生充满了起伏。他才华横溢，却因为政治立场多次被贬谪，从繁华的京城一路被贬到偏远的海南。\n\n最困难的时候，他在黄州当团练副使，相当于"有职无权"的闲职。生活拮据，还要自己种地养家。换作别人，可能早就抱怨命运不公了。\n\n但苏轼没有。他在黄州写下了《赤壁赋》《后赤壁赋》等传世名作。他说："竹杖芒鞋轻胜马，谁怕？一蓑烟雨任平生。"把被贬的苦难，活成了诗意的人生。\n\n他明白有些事情自己无法控制，比如政治风向、他人的偏见。但他可以控制自己的心境，可以选择用什么态度面对困境。于是困苦的流放生活，反而成就了他文学上的巅峰。`,
                    reflection: "💭 苏轼教会我们：当我们无法改变环境时，可以改变自己看待环境的方式。专注于自己能掌控的部分，在限制中创造自由。"
                },
                {
                    title: "甘地：用柔软改变世界",
                    text: `面对英国的殖民统治，很多人选择暴力反抗，但甘地选择了一条不同的路：非暴力不合作。\n\n1930年，英国政府垄断食盐销售，普通印度人连吃盐都要交税。甘地没有选择武装起义，而是带领民众徒步390公里到海边，亲手制盐。这个简单的动作，却撼动了整个殖民体系。\n\n甘地明白，他无法直接推翻英国统治，无法改变殖民者的想法。但他可以选择自己的行动方式，可以用道德的力量感化对手。他说："成为你希望在世界上看到的改变。"\n\n最终，印度独立了。甘地证明：有时候，最大的力量不是对抗，而是坚持；不是改变别人，而是成为更好的自己。`,
                    reflection: "💭 甘地提醒我们：在无法强力改变外界时，我们可以通过改变自己的行为方式来影响世界。"
                },
                {
                    title: "稻盛和夫：在平凡中追求卓越",
                    text: `稻盛和夫大学毕业后进入一家快要倒闭的陶瓷公司，工资微薄，前途未卜。同期入职的同事都跳槽了，只有他留了下来。\n\n他没有抱怨环境，而是决定把手头的工作做到极致。在简陋的实验室里，他每天工作到深夜，反复试验新材料配方。有时实验失败了，他就从头再来。\n\n有人问他为什么这么拼，他说："我控制不了公司的命运，但我可以控制自己的努力程度。"就这样，他在这个小公司里研发出了多项革命性的陶瓷技术。\n\n后来他创办了京瓷公司，又创办了KDDI，两家公司都进入世界500强。78岁时还临危受命拯救日航。他用一生践行：在有限的条件下，把能做的事情做到最好。`,
                    reflection: "💭 稻盛和夫告诉我们：不必抱怨环境的局限，专注于在现有条件下把事情做到最好，奇迹就会出现。"
                },
                {
                    title: "乔布斯：被逐出苹果后的重新思考",
                    text: `1985年，30岁的乔布斯被自己一手创办的苹果公司赶走了。这对他来说是巨大的打击，媒体嘲笑他，投资人质疑他，连朋友都开始疏远他。\n\n乔布斯本可以一蹶不振，但他选择了重新开始。他说："被苹果开除是我遇到的最好的事情。"离开苹果后，他创办了NeXT公司，还收购了皮克斯动画工作室。\n\n在NeXT，他可以放手实现自己的技术理想；在皮克斯，他学会了讲故事的艺术。12年后，当苹果陷入困境时，他们收购了NeXT，乔布斯重新回到苹果。\n\n这时的乔布斯已经不是当年那个偏执的年轻人了。他学会了倾听，学会了合作，学会了在约束中创新。于是有了iPod、iPhone、iPad，苹果重新成为世界上最伟大的公司之一。`,
                    reflection: "💭 乔布斯的经历提醒我们：有时候失去是为了更好的得到。在无法控制外界变化时，我们可以控制自己的成长。"
                },
                {
                    title: "村上春树：在坚持中寻找节奏",
                    text: `村上春树29岁才开始写小说，当时他经营着一家爵士酒吧，每天要忙到凌晨。很多人劝他专心做一件事，但他选择了平衡。\n\n白天经营酒吧，深夜写小说。他无法控制读者是否喜欢他的作品，无法控制出版社是否接受他的稿件，但他可以控制自己的写作节奏。\n\n他给自己定下规矩：每天写400字，不多不少。有灵感也不贪多，没灵感也不偷懒。他说："我不是天才，但我可以做到持之以恒。"\n\n30多年来，村上春树几乎每天都在写作，同时坚持跑步、翻译、听爵士乐。他在确定性的节奏中应对不确定的创作，最终成为世界级作家。他证明：有时候，最好的策略不是孤注一掷，而是稳定持续。`,
                    reflection: "💭 村上春树教给我们：在不确定的世界里，我们可以为自己创造确定的节奏，在平衡中找到前进的力量。"
                }
            ],
            uncontrollable: [
                {
                    title: "林肯：用宽恕的心包容一切",
                    text: `美国内战结束后，林肯面临一个巨大的选择：如何对待南方的战败者？\n\n当时很多北方人都充满仇恨，要求严厉惩罚南方。林肯的顾问们也建议他采取强硬立场。但林肯选择了宽恕。\n\n他说："我们不能用仇恨来结束仇恨。"他制定了宽松的重建计划，希望南北重新团结。虽然这个决定让他承受了巨大压力，甚至可能因此遇刺，但他始终坚持。\n\n林肯明白，他无法控制别人心中的仇恨，无法改变战争造成的创伤，也无法让所有人都理解他的选择。但他可以选择自己的态度：用包容代替报复，用理解代替指责。\n\n虽然他最终遇害，但他的宽恕精神却成为了美国重新团结的基础。`,
                    reflection: "💭 林肯提醒我们：面对无法改变的过去和他人的行为，我们依然可以选择宽恕与包容。这不是软弱，而是内心强大的体现。"
                },
                {
                    title: "曼德拉：在监狱中学会原谅",
                    text: `曼德拉在监狱里待了27年。27年！这是一个人生命中最宝贵的年华。任何人都有理由愤怒、仇恨、报复。\n\n但神奇的是，当曼德拉走出监狱时，他脸上没有仇恨，只有宽容。他邀请曾经的看守参加自己的就职典礼，他主动拜访种族隔离制度的前总统。\n\n有人问他为什么能够原谅，他说："怨恨如同监狱，它把我们困住。当我走出监狱时，我知道如果我继续恨下去，我就永远不会真正自由。"\n\n曼德拉明白，他无法改变已经失去的27年，无法改变过去的痛苦，也无法让所有白人都理解黑人的苦难。但他可以选择不让仇恨继续毒害自己的心灵。\n\n正是这种包容，让南非避免了血腥的种族报复，实现了和平过渡。`,
                    reflection: "💭 曼德拉告诉我们：真正的自由不是报复，而是放下。当我们学会原谅时，我们就解放了自己。"
                },
                {
                    title: "弘一法师：在放下中获得宁静",
                    text: `李叔同曾经是民国时期的艺术天才，精通诗词、书法、绘画、音乐。他创作的《送别》至今还在传唱。39岁时，他却突然出家了，成为弘一法师。\n\n很多人不理解：为什么要放弃那么多？名声、财富、艺术成就，这些不都是别人梦寐以求的吗？\n\n弘一法师说："我在艺术中追求完美，但发现外在的完美是无穷无尽的。总有更好的作品，总有更高的名声，总有更多的赞美。这种追求让我越来越疲惫。"\n\n出家后，他专心研究佛法，写字诵经，生活简朴。他不再在意别人的评价，不再追求外在的成就，不再为无法控制的事情烦恼。反而，他找到了内心真正的平静。\n\n他的书法也在这种平静中达到了新的境界，朴素中蕴含着深远的韵味。`,
                    reflection: "💭 弘一法师提醒我们：有时候，最大的得到来自于放下。当我们不再执着于无法控制的外在时，内心反而获得了真正的自由。"
                },
                {
                    title: "苏格拉底：智慧就是知道自己的无知",
                    text: `苏格拉底被誉为古希腊最智慧的人，但他却说："我只知道一件事，就是我什么都不知道。"\n\n有一次，一个年轻人问他："老师，怎样才能获得智慧？"苏格拉底把他带到河边，突然把他按到水里。年轻人拼命挣扎，终于露出水面，大口喘气。\n\n苏格拉底问："在水下时，你最想要什么？"年轻人说："空气！"苏格拉底说："当你渴望智慧就像刚才渴望空气一样时，你就能获得智慧了。"\n\n苏格拉底明白，世界上有太多东西是我们无法掌控的：别人的想法、自然的规律、生命的长短。但我们可以控制自己的求知欲，可以选择保持谦逊和好奇。\n\n正是这种"无知的智慧"，让苏格拉底成为了西方哲学的奠基人。他接纳自己的有限性，反而获得了无限的可能。`,
                    reflection: "💭 苏格拉底教会我们：承认自己的无知和有限，反而是智慧的开始。接纳不确定性，我们才能获得内心的平静。"
                },
                {
                    title: "老子：上善若水的人生哲学",
                    text: `老子说："上善若水。水善利万物而不争，处众人之所恶，故几于道。"\n\n水是什么样的？它柔软、透明、没有固定形状。倒在方杯里它是方的，倒在圆杯里它是圆的。它从不与任何东西争抢，总是往低处流，润泽万物却不求回报。\n\n但正是这种"不争"，让水拥有了最大的力量。滴水穿石，水能载舟也能覆舟。最柔软的东西，反而能战胜最坚硬的东西。\n\n老子用水来比喻最高的智慧：我们无法控制遇到什么样的容器（环境），但我们可以像水一样适应任何环境；我们无法控制别人是否感激，但我们可以选择无私地给予；我们无法控制结果，但我们可以选择不争不抢的心态。\n\n这种"水的智慧"让我们在任何环境中都能找到自己的位置，在任何困难中都能保持内心的平静。`,
                    reflection: "💭 老子告诉我们：真正的强大不是征服，而是包容；真正的智慧不是争夺，而是适应。像水一样生活，我们就能在任何环境中都保持内心的宁静。"
                }
            ]
        };
        
        function selectAnxietyType(type) {
            currentAnxietyType = type;
            showAffirmation();
        }
        
        function showAffirmation() {
            // 随机选择一个暗示语句
            const affirmationList = affirmations[currentAnxietyType];
            const randomAffirmation = affirmationList[Math.floor(Math.random() * affirmationList.length)];
            
            // 设置页面背景色
            const page = document.getElementById('affirmation');
            const backgrounds = {
                controllable: 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)',
                'semi-controllable': 'linear-gradient(135deg, #FF9800 0%, #f57c00 100%)',
                uncontrollable: 'linear-gradient(135deg, #2196F3 0%, #1976d2 100%)'
            };
            page.style.setProperty('--page-bg', backgrounds[currentAnxietyType]);
            
            // 显示暗示内容
            document.getElementById('affirmationText').textContent = randomAffirmation;
            
            // 切换页面
            switchPage('affirmation');
            
            // 15秒后自动进入过渡页面
            setTimeout(() => {
                switchPage('transition');
            }, 15000);
        }
        
        function getNextStory(anxietyType) {
            const storyList = stories[anxietyType];
            const usedList = usedStories[anxietyType];
            
            // 如果所有故事都已使用，重置使用记录
            if (usedList.length >= storyList.length) {
                usedStories[anxietyType] = [];
            }
            
            // 找到未使用的故事
            const availableIndices = [];
            for (let i = 0; i < storyList.length; i++) {
                if (!usedStories[anxietyType].includes(i)) {
                    availableIndices.push(i);
                }
            }
            
            // 随机选择一个未使用的故事
            const randomIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
            usedStories[anxietyType].push(randomIndex);
            currentStoryIndex = randomIndex;
            
            return storyList[randomIndex];
        }
        
        function endSession() {
            alert('愿你今天过得更好一些 ✨\n记住，你已经很棒了！');
            startOver();
        }
        
        function goToStory() {
            const story = getNextStory(currentAnxietyType);
            
            document.getElementById('storyTitle').textContent = story.title;
            document.getElementById('storyText').textContent = story.text;
            document.getElementById('storyReflection').textContent = story.reflection;
            
            switchPage('story');
        }
        
        function anotherStory() {
            // 获取当前类型的下一个未重复故事
            const story = getNextStory(currentAnxietyType);
            
            document.getElementById('storyTitle').textContent = story.title;
            document.getElementById('storyText').textContent = story.text;
            document.getElementById('storyReflection').textContent = story.reflection;
            
            // 滚动到顶部
            document.querySelector('.story-content').scrollTop = 0;
        }
        
        function startOver() {
            currentAnxietyType = '';
            // 重置当前类型的故事使用记录
            for (let type in usedStories) {
                usedStories[type] = [];
            }
            currentStoryIndex = -1;
            switchPage('selection');
        }
        
        function goBack() {
            const pageOrder = ['selection', 'affirmation', 'transition', 'story'];
            const currentIndex = pageOrder.indexOf(currentPage);
            if (currentIndex > 0) {
                switchPage(pageOrder[currentIndex - 1]);
            }
        }
        
        function switchPage(pageId) {
            // 隐藏所有页面
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示目标页面
            document.getElementById(pageId).classList.add('active');
            currentPage = pageId;
            
            // 滚动到顶部
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
