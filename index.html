<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒå®‰å¤„ - ç„¦è™‘ç¼“è§£å°ç«™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        /* èƒŒæ™¯è£…é¥°å…ƒç´  */
        .bg-decoration {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }
        
        .floating-element {
            position: absolute;
            opacity: 0.1;
            animation: float 20s infinite linear;
        }
        
        .floating-element:nth-child(1) {
            top: 10%;
            left: 10%;
            font-size: 2rem;
            animation-delay: 0s;
        }
        
        .floating-element:nth-child(2) {
            top: 20%;
            right: 20%;
            font-size: 1.5rem;
            animation-delay: -5s;
        }
        
        .floating-element:nth-child(3) {
            bottom: 30%;
            left: 15%;
            font-size: 1.8rem;
            animation-delay: -10s;
        }
        
        .floating-element:nth-child(4) {
            top: 60%;
            right: 10%;
            font-size: 2.2rem;
            animation-delay: -15s;
        }
        
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(90deg); }
            50% { transform: translateY(-10px) rotate(180deg); }
            75% { transform: translateY(-15px) rotate(270deg); }
            100% { transform: translateY(0px) rotate(360deg); }
        }
        
        /* éŸ³ä¹æ§åˆ¶å™¨ */
        .music-control {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.15);
            padding: 8px 12px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .music-control:hover {
            background: rgba(255,255,255,0.25);
        }
        
        .music-btn {
            background: transparent;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
        }
        
        .music-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.1);
        }
        
        .music-btn.playing {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.4); }
            70% { box-shadow: 0 0 0 8px rgba(255,255,255,0); }
            100% { box-shadow: 0 0 0 0 rgba(255,255,255,0); }
        }
        
        .music-info {
            color: white;
            font-size: 0.8rem;
            opacity: 0.9;
            white-space: nowrap;
        }
        
        .volume-control {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .volume-slider {
            width: 60px;
            height: 3px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
        
        .page {
            height: 100vh;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }
        
        .page.active {
            display: flex;
        }
        
        /* æ¬¢è¿é¡µé¢ */
        .welcome-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            text-align: center;
        }
        
        .welcome-content {
            color: white;
            max-width: min(500px, 90vw);
        }
        
        .welcome-title {
            font-size: clamp(2rem, 5vw, 2.5rem);
            margin-bottom: 20px;
            font-weight: 300;
            letter-spacing: 2px;
        }
        
        .welcome-subtitle {
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            margin-bottom: 40px;
            opacity: 0.9;
            line-height: 1.5;
        }
        
        .start-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: clamp(15px, 4vw, 20px) clamp(30px, 8vw, 40px);
            border-radius: 50px;
            font-size: clamp(1.1rem, 3vw, 1.2rem);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .start-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        /* å¼•å¯¼é€‰æ‹©é¡µé¢ */
        .guide-page {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            text-align: center;
        }
        
        .guide-content {
            color: white;
            max-width: min(450px, 90vw);
        }
        
        .guide-question {
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            margin-bottom: clamp(30px, 8vw, 40px);
            font-weight: 300;
            line-height: 1.4;
        }
        
        .guide-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .guide-btn {
            background: white;
            color: #2c3e50;
            border: none;
            padding: clamp(16px, 4vw, 20px) clamp(25px, 6vw, 35px);
            border-radius: 50px;
            font-size: clamp(1rem, 2.5vw, 1.1rem);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .guide-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        /* ç„¦è™‘ç±»å‹é€‰æ‹©é¡µé¢ */
        .selection-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        .header h1 {
            font-size: clamp(1.6rem, 4vw, 2rem);
            margin-bottom: 10px;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .header p {
            font-size: clamp(1rem, 2.5vw, 1.1rem);
            opacity: 0.9;
            line-height: 1.4;
        }
        
        .cards-container {
            width: 100%;
            max-width: min(400px, 90vw);
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            padding: 20px 18px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--accent-color);
        }
        
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.2);
        }
        
        .card-controllable { --accent-color: #4CAF50; }
        .card-semi-controllable { --accent-color: #FF9800; }
        .card-uncontrollable { --accent-color: #2196F3; }
        
        .character {
            font-size: 2.5rem;
            margin-bottom: 10px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        
        .card-title {
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            font-weight: 600;
            margin-bottom: 6px;
            color: #2c3e50;
        }
        
        .card-subtitle {
            font-size: clamp(0.85rem, 2vw, 0.9rem);
            color: #7f8c8d;
            margin-bottom: 12px;
        }
        
        .examples {
            text-align: left;
            color: #5a6c7d;
            font-size: clamp(0.8rem, 1.8vw, 0.85rem);
            line-height: 1.4;
        }
        
        .examples ul {
            list-style: none;
            padding: 0;
        }
        
        .examples li {
            padding: 2px 0;
            position: relative;
            padding-left: 12px;
        }
        
        .examples li:before {
            content: 'â€¢';
            color: var(--accent-color);
            position: absolute;
            left: 0;
        }
        
        /* æ”¾æ¾æ¨¡å¼é¡µé¢ */
        .relax-page {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            text-align: center;
        }
        
        .relax-content {
            color: white;
            max-width: min(500px, 90vw);
        }
        
        .relax-title {
            font-size: clamp(1.8rem, 4.5vw, 2.2rem);
            margin-bottom: clamp(20px, 5vw, 30px);
            font-weight: 300;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .relax-subtitle {
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            margin-bottom: clamp(30px, 8vw, 40px);
            opacity: 0.9;
            line-height: 1.5;
        }
        
        .relax-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .relax-option {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: clamp(20px, 5vw, 25px) clamp(15px, 3vw, 20px);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            text-align: center;
        }
        
        .relax-option:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .relax-option .icon {
            font-size: 2rem;
            display: block;
            margin-bottom: 8px;
        }
        
        .relax-option .text {
            font-size: clamp(0.9rem, 2vw, 1rem);
            font-weight: 500;
        }
        
        /* å…¶ä»–é¡µé¢æ ·å¼ä¿æŒä¸å˜ */
        .affirmation-page {
            background: var(--page-bg);
            text-align: center;
        }
        
        .affirmation-content {
            max-width: min(600px, 90vw);
            color: white;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .affirmation-text {
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            line-height: 1.5;
            margin-bottom: clamp(20px, 6vh, 40px);
            font-weight: 300;
            letter-spacing: 1px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .breathing-guide {
            font-size: clamp(1rem, 2.5vw, 1.1rem);
            opacity: 0.8;
            margin-bottom: clamp(15px, 4vh, 30px);
        }
        
        .breathing-circle {
            width: clamp(80px, 15vw, 100px);
            height: clamp(80px, 15vw, 100px);
            border: 3px solid rgba(255,255,255,0.5);
            border-radius: 50%;
            margin: 0 auto clamp(20px, 5vh, 40px);
            position: relative;
            animation: breathe 4s infinite;
        }
        
        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.15); opacity: 1; }
        }
        
        .progress-bar {
            width: clamp(150px, 40vw, 200px);
            height: 4px;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            margin: 0 auto;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: white;
            width: 0%;
            border-radius: 2px;
            animation: progress 15s linear;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        
        @keyframes progress {
            to { width: 100%; }
        }
        
        /* è¿”å›æŒ‰é’® */
        .back-btn {
            position: absolute;
            top: clamp(15px, 3vh, 30px);
            left: clamp(15px, 3vw, 30px);
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: clamp(8px, 2vw, 10px) clamp(12px, 3vw, 15px);
            border-radius: 20px;
            cursor: pointer;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            .music-control {
                top: 15px;
                right: 15px;
                padding: 6px 10px;
            }
            
            .music-info {
                font-size: 0.75rem;
            }
            
            .volume-slider {
                width: 50px;
            }
        }
        
        /* é«˜åº¦è¾ƒå°çš„å±å¹•ä¼˜åŒ– */
        @media (max-height: 600px) {
            .welcome-title {
                font-size: 1.8rem;
                margin-bottom: 15px;
            }
            
            .welcome-subtitle {
                font-size: 1rem;
                margin-bottom: 25px;
            }
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯è£…é¥°å…ƒç´  -->
    <div class="bg-decoration">
        <div class="floating-element">ğŸŒ¸</div>
        <div class="floating-element">â˜ï¸</div>
        <div class="floating-element">ğŸƒ</div>
        <div class="floating-element">â­</div>
    </div>
    
    <!-- éŸ³ä¹æ§åˆ¶å™¨ -->
    <div class="music-control">
        <button class="music-btn" id="playBtn" onclick="toggleMusic()">â–¶ï¸</button>
        <button class="music-btn" id="nextBtn" onclick="nextTrack()">â­ï¸</button>
        <div class="music-info" id="musicInfo">è½»éŸ³ä¹ 1</div>
        <div class="volume-control">
            <span style="color: white; font-size: 0.8rem;">ğŸ”Š</span>
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50" onchange="setVolume(this.value)">
        </div>
    </div>
    
    <!-- éšè—çš„éŸ³é¢‘å…ƒç´  -->
    <audio id="bgMusic" loop preload="metadata">
        <source src="https://github.com/firekylin2024/ease-anxiety/raw/main/music/796500.mp3" type="audio/mpeg">
    </audio>
    
    <!-- é¡µé¢1ï¼šæ¬¢è¿é¡µé¢ -->
    <div class="page welcome-page active" id="welcome">
        <div class="welcome-content">
            <h1 class="welcome-title">å¿ƒå®‰å¤„</h1>
            <p class="welcome-subtitle">åœ¨è¿™é‡Œï¼Œè®©å¿ƒçµæ‰¾åˆ°å®é™<br>éŸ³ä¹ä¸æ–‡å­—ï¼Œé™ªä¼´ä½ çš„æ¯ä¸€åˆ»</p>
            <button class="start-btn" onclick="startExperience()">ç‚¹å‡»å¼€å§‹ï¼Œä½“éªŒå®é™æ—¶å…‰ âœ¨</button>
        </div>
    </div>
    
    <!-- é¡µé¢2ï¼šå¼•å¯¼é€‰æ‹© -->
    <div class="page guide-page" id="guide">
        <div class="guide-content">
            <div class="guide-question">æ­¤åˆ»çš„ä½ ï¼Œå¿ƒé‡Œæœ‰ä»€ä¹ˆåœ¨å›°æ‰°å—ï¼Ÿ</div>
            <div class="guide-options">
                <button class="guide-btn" onclick="selectPath('anxiety')">æ˜¯çš„ï¼Œæœ‰ç‚¹ç„¦è™‘ ğŸ˜”</button>
                <button class="guide-btn" onclick="selectPath('relax')">è¿˜å¥½ï¼Œåªæ˜¯æƒ³æ”¾æ¾ä¸€ä¸‹ ğŸ˜Œ</button>
            </div>
        </div>
    </div>
    
    <!-- é¡µé¢3ï¼šç„¦è™‘ç±»å‹é€‰æ‹© -->
    <div class="page selection-page" id="selection">
        <button class="back-btn" onclick="goBack()">â† è¿”å›</button>
        <div class="header">
            <h1>è¿™ç§å›°æ‰°ï¼Œä½ è§‰å¾—...</h1>
            <p>é€‰æ‹©æœ€ç¬¦åˆä½ å†…å¿ƒæ„Ÿå—çš„ç­”æ¡ˆ</p>
        </div>
        
        <div class="cards-container">
            <div class="card card-controllable" onclick="selectAnxietyType('controllable')">
                <div class="character">ğŸŒ±</div>
                <h3 class="card-title">æˆ‘è§‰å¾—å¯ä»¥åŠªåŠ›æ”¹å˜</h3>
                <p class="card-subtitle">åƒå¹¼è‹—ä¸€æ ·ï¼Œç”¨å¿ƒæµ‡çŒæˆé•¿</p>
                <div class="examples">
                    <ul>
                        <li>å·¥ä½œè¡¨ç°å’Œå­¦ä¹ æˆç»©</li>
                        <li>äººé™…æ²Ÿé€šå’Œç¤¾äº¤æŠ€å·§</li>
                        <li>ç”Ÿæ´»ä¹ æƒ¯å’Œæ—¶é—´ç®¡ç†</li>
                        <li>æŠ€èƒ½æå‡å’Œèƒ½åŠ›åŸ¹å…»</li>
                    </ul>
                </div>
            </div>
            
            <div class="card card-semi-controllable" onclick="selectAnxietyType('semi-controllable')">
                <div class="character">â˜¯ï¸</div>
                <h3 class="card-title">æˆ‘èƒ½å½±å“ä¸€éƒ¨åˆ†</h3>
                <p class="card-subtitle">åƒå¤ªæå¸ˆä¸€æ ·ï¼Œé¡ºåŠ¿è€Œä¸º</p>
                <div class="examples">
                    <ul>
                        <li>å¥åº·çŠ¶å†µå’Œèº«ä½“æœºèƒ½</li>
                        <li>å·¥ä½œæœºä¼šå’ŒèŒä¸šå‘å±•</li>
                        <li>äº²å¯†å…³ç³»å’Œå®¶åº­å’Œè°</li>
                        <li>æŠ•èµ„ç†è´¢å’Œç»æµçŠ¶å†µ</li>
                    </ul>
                </div>
            </div>
            
            <div class="card card-uncontrollable" onclick="selectAnxietyType('uncontrollable')">
                <div class="character">ğŸŒŠ</div>
                <h3 class="card-title">å¥½åƒè¶…å‡ºäº†æˆ‘çš„æ§åˆ¶</h3>
                <p class="card-subtitle">åƒå¤§æµ·ä¸€æ ·ï¼ŒåŒ…å®¹æ¥çº³ä¸€åˆ‡</p>
                <div class="examples">
                    <ul>
                        <li>ä»–äººçš„æƒ³æ³•å’Œè¡Œä¸º</li>
                        <li>è¿‡å»å‘ç”Ÿçš„äº‹æƒ…</li>
                        <li>æœªæ¥çš„ä¸ç¡®å®šæ€§</li>
                        <li>è‡ªç„¶ç¯å¢ƒå’Œç¤¾ä¼šå˜åŒ–</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- é¡µé¢4ï¼šæ”¾æ¾æ¨¡å¼ -->
    <div class="page relax-page" id="relax">
        <button class="back-btn" onclick="goBack()">â† è¿”å›</button>
        <div class="relax-content">
            <h1 class="relax-title">æ”¾æ¾ä¸€ä¸‹å§</h1>
            <p class="relax-subtitle">é€‰æ‹©ä½ å–œæ¬¢çš„æ–¹å¼ï¼Œè®©å¿ƒçµå¾—åˆ°ç‰‡åˆ»å®‰å®</p>
            
            <div class="relax-options">
                <button class="relax-option" onclick="focusOnMusic()">
                    <span class="icon">ğŸµ</span>
                    <span class="text">ä¸“å¿ƒå¬éŸ³ä¹</span>
                </button>
                <button class="relax-option" onclick="showBreathing()">
                    <span class="icon">ğŸ«</span>
                    <span class="text">æ·±å‘¼å¸ç»ƒä¹ </span>
                </button>
                <button class="relax-option" onclick="showVisualRelax()">
                    <span class="icon">ğŸŒŠ</span>
                    <span class="text">è§†è§‰æ”¾æ¾</span>
                </button>
                <button class="relax-option" onclick="readPositiveText()">
                    <span class="icon">âœ¨</span>
                    <span class="text">æ¸©æš–æ–‡å­—</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- é¡µé¢5ï¼šå¿ƒç†æš—ç¤º -->
    <div class="page affirmation-page" id="affirmation">
        <button class="back-btn" onclick="goBack()">â† è¿”å›</button>
        <div class="affirmation-content">
            <div class="affirmation-text" id="affirmationText">
                <!-- æš—ç¤ºå†…å®¹å°†ç”±JSå¡«å…¥ -->
            </div>
            <div class="breathing-guide">æ·±å‘¼å¸ä¸‰æ¬¡ï¼Œè®©è¿™å¥è¯æ…¢æ…¢æ²‰å…¥å¿ƒé‡Œ</div>
            <div class="breathing-circle"></div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>
    
    <script>
        // éŸ³ä¹ç®¡ç†
        const musicLibrary = [
            { file: "796500.mp3", name: "è½»éŸ³ä¹ 1" },
            { file: "788974.mp3", name: "è½»éŸ³ä¹ 2" },
            { file: "127566.mp3", name: "è½»éŸ³ä¹ 3" },
            { file: "125566.mp3", name: "è½»éŸ³ä¹ 4" }
        ];
        
        let currentTrackIndex = 0;
        let isPlaying = false;
        let currentAnxietyType = '';
        let currentPage = 'welcome';
        
        // æš—ç¤ºè¯­å¥åº“
        const affirmations = {
            controllable: [
                "æˆ‘æœ‰èƒ½åŠ›é€šè¿‡åŠªåŠ›æ”¹å˜ç°çŠ¶",
                "æ¯ä¸€ä¸ªå°æ­¥éª¤éƒ½åœ¨è®©æˆ‘å˜å¾—æ›´å¥½", 
                "æˆ‘å¯ä»¥å­¦ä¹ ï¼Œæˆ‘å¯ä»¥æˆé•¿ï¼Œæˆ‘å¯ä»¥æ”¹å˜",
                "å›°éš¾æ˜¯æˆ‘æˆé•¿è·¯ä¸Šçš„å«è„šçŸ³"
            ],
            'semi-controllable': [
                "æˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ï¼Œç„¶åå¹³é™æ¥å—ç»“æœ",
                "æœ‰äº›äº‹æˆ‘èƒ½å½±å“ï¼Œæœ‰äº›äº‹æˆ‘éœ€è¦é¡ºåº”",
                "æˆ‘ä¸“æ³¨äºè‡ªå·±èƒ½æ§åˆ¶çš„éƒ¨åˆ†",
                "åœ¨å˜åŒ–ä¸­å¯»æ‰¾å¹³è¡¡ï¼Œåœ¨åŠªåŠ›ä¸­ä¿æŒä»å®¹"
            ],
            uncontrollable: [
                "è¿™ç§æ„Ÿå—æ˜¯æ­£å¸¸çš„ï¼Œæˆ‘å…è®¸å®ƒå­˜åœ¨",
                "æœ‰äº›äº‹æƒ…è¶…å‡ºæˆ‘çš„æ§åˆ¶ï¼Œæˆ‘é€‰æ‹©æ”¾ä¸‹",
                "åƒå¤§æµ·ä¸€æ ·ï¼Œæˆ‘å¯ä»¥åŒ…å®¹ä¸€åˆ‡",
                "æ¥çº³å½“ä¸‹çš„è‡ªå·±ï¼Œå°±æ˜¯æœ€å¤§çš„å‹‡æ°”"
            ]
        };
        
        // éŸ³ä¹æ§åˆ¶å‡½æ•°
        function toggleMusic() {
            const audio = document.getElementById('bgMusic');
            const playBtn = document.getElementById('playBtn');
            
            if (!isPlaying) {
                audio.play().then(() => {
                    isPlaying = true;
                    playBtn.textContent = 'â¸ï¸';
                    playBtn.classList.add('playing');
                }).catch(e => {
                    console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e);
                });
            } else {
                audio.pause();
                isPlaying = false;
                playBtn.textContent = 'â–¶ï¸';
                playBtn.classList.remove('playing');
            }
        }
        
        function nextTrack() {
            currentTrackIndex = (currentTrackIndex + 1) % musicLibrary.length;
            loadTrack(currentTrackIndex);
        }
        
        function loadTrack(index) {
            const audio = document.getElementById('bgMusic');
            const musicInfo = document.getElementById('musicInfo');
            const track = musicLibrary[index];
            
            // æ›´æ–°éŸ³é¢‘æºï¼ˆæ³¨æ„ï¼šéœ€è¦æ›¿æ¢ä¸ºä½ çš„å®é™…GitHub URLï¼‰
            audio.src = `https://github.com/firekylin2024/ease-anxiety/raw/main/music/${track.file}`;
            musicInfo.textContent = track.name;
            
            // å¦‚æœæ­£åœ¨æ’­æ”¾ï¼Œåˆ‡æ¢åˆ°æ–°éŸ³ä¹
            if (isPlaying) {
                audio.play().catch(e => console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e));
            }
        }
        
        function setVolume(value) {
            const audio = document.getElementById('bgMusic');
            audio.volume = value / 100;
        }
        
        // é¡µé¢å¯¼èˆªå‡½æ•°
        function startExperience() {
            // å¼€å§‹æ—¶è‡ªåŠ¨æ’­æ”¾éŸ³ä¹
            toggleMusic();
            switchPage('guide');
        }
        
        function selectPath(path) {
            if (path === 'anxiety') {
                switchPage('selection');
            } else {
                switchPage('relax');
            }
        }
        
        function selectAnxietyType(type) {
            currentAnxietyType = type;
            showAffirmation();
        }
        
        function showAffirmation() {
            const affirmationList = affirmations[currentAnxietyType];
            const randomAffirmation = affirmationList[Math.floor(Math.random() * affirmationList.length)];
            
            const page = document.getElementById('affirmation');
            const backgrounds = {
                controllable: 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)',
                'semi-controllable': 'linear-gradient(135deg, #FF9800 0%, #f57c00 100%)',
                uncontrollable: 'linear-gradient(135deg, #2196F3 0%, #1976d2 100%)'
            };
            page.style.setProperty('--page-bg', backgrounds[currentAnxietyType]);
            
            document.getElementById('affirmationText').textContent = randomAffirmation;
            switchPage('affirmation');
            
            // 15ç§’åè‡ªåŠ¨è¿”å›é€‰æ‹©é¡µé¢æˆ–ç»“æŸ
            setTimeout(() => {
                alert('æ„¿ä½ ä»Šå¤©è¿‡å¾—æ›´å¥½ä¸€äº› âœ¨\nè®°ä½ï¼Œä½ å·²ç»å¾ˆæ£’äº†ï¼');
                switchPage('welcome');
            }, 15000);
        }
        
        // æ”¾æ¾æ¨¡å¼åŠŸèƒ½
        function focusOnMusic() {
            alert('ğŸµ ä¸“å¿ƒå¬éŸ³ä¹æ¨¡å¼\n\né—­ä¸Šçœ¼ç›ï¼Œè®©éŸ³ä¹æ´—æ¶¤å¿ƒçµ\nå»ºè®®å¬ 3-5 åˆ†é’Ÿï¼Œæ„Ÿå—å†…å¿ƒçš„å¹³é™');
        }
        
        function showBreathing() {
            alert('ğŸ« æ·±å‘¼å¸ç»ƒä¹ \n\nå¸æ°” 4 ç§’ - å±æ¯ 7 ç§’ - å‘¼æ°” 8 ç§’\né‡å¤ 5-10 æ¬¡ï¼Œæ„Ÿå—èº«å¿ƒçš„æ”¾æ¾');
        }
        
        function showVisualRelax() {
            alert('ğŸŒŠ è§†è§‰æ”¾æ¾\n\næ³¨è§†å±å¹•ä¸Šé£˜æµ®çš„å…ƒç´ \nè®©æ€ç»ªéšç€å®ƒä»¬ä¸€èµ·è½»ç›ˆåœ°é£˜æµ®');
        }
        
        function readPositiveText() {
            const positiveTexts = [
                "æ¯ä¸€ä¸ªå½“ä¸‹éƒ½æ˜¯å…¨æ–°çš„å¼€å§‹",
                "ä½ æ¯”ä½ æƒ³è±¡çš„æ›´åšå¼º",
                "æ…¢ä¸‹æ¥ï¼Œç”Ÿæ´»ä¼šç»™ä½ ç­”æ¡ˆ",
                "ä¸–ç•Œä¸Šæœ€æ¸©æŸ”çš„åŠ›é‡æ˜¯å†…å¿ƒçš„å¹³é™",
                "ä»Šå¤©çš„ä½ å·²ç»è¶³å¤Ÿå¥½äº†"
            ];
            const randomText = positiveTexts[Math.floor(Math.random() * positiveTexts.length)];
            alert(`âœ¨ ${randomText} âœ¨\n\nè®©è¿™å¥è¯åœ¨å¿ƒä¸­åœç•™ä¸€ä¼šå„¿`);
        }
        
        function goBack() {
            const pageOrder = ['welcome', 'guide', 'selection', 'relax', 'affirmation'];
            const currentIndex = pageOrder.indexOf(currentPage);
            if (currentIndex > 0) {
                switchPage(pageOrder[currentIndex - 1]);
            }
        }
        
        function switchPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.getElementById(pageId).classList.add('active');
            currentPage = pageId;
            window.scrollTo(0, 0);
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®åˆå§‹éŸ³é‡
            setVolume(50);
            
            // åŠ è½½ç¬¬ä¸€é¦–éŸ³ä¹
            loadTrack(0);
            
            // éŸ³ä¹ç»“æŸæ—¶è‡ªåŠ¨ä¸‹ä¸€é¦–
            document.getElementById('bgMusic').addEventListener('ended', nextTrack);
        });
    </script>
</body>
</html>